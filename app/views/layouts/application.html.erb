<!DOCTYPE html>
<html class="govuk-template--rebranded app-html-class">
  <head>
    <title><%= content_for(:title) || "UK Trade Tariff Developer Portal" %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta charset="utf-8">
    <meta name="theme-color" content="#1d70b8">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= favicon_link_tag 'favicon.ico' %>
    <%= favicon_link_tag 'favicon.svg' %>
    <%= favicon_link_tag 'govuk-icon-mask.svg', rel: 'mask-icon', type: 'image/svg', color: "#0b1c0c" %>
    <%= favicon_link_tag 'govuk-icon-180.png', rel: 'apple-touch-icon', type: 'image/png', size: '180x180' %>

    <%= stylesheet_link_tag "govuk-frontend.min", "data-turbo-track": "reload" %>

    <%= javascript_importmap_tags %>
  </head>

  <%= govuk_header(homepage_url: ENV.fetch("GOVUK_APP_DOMAIN", "http://localhost:3000"), service_name: "UK Trade Tariff Developer Portal", service_url: "#") do |header|
    if respond_to?(:current_user) && current_user.present?
      if organisation&.admin?
        header.with_navigation_item(text: "All Organisations", href: admin_organisations_path, active: current_page?(admin_organisations_path))
      end
      if organisation&.fpo_access?
        header.with_navigation_item(text: "FPO Keys", href: api_keys_path, active: current_page?(api_keys_path))
      end
      if organisation&.ott_access?
        header.with_navigation_item(text: "OTT Keys", href: ott_keys_path, active: current_page?(ott_keys_path))
      end
      header.with_navigation_item(text: "Manage organisation", href: organisation_path(current_user.organisation))
      header.with_navigation_item(text: "Sign Out", href: logout_path, active: false)
    end
  end %>

  <body class="govuk-template__body app-body-class">
    <div class="govuk-width-container app-width-container">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>
    <%= govuk_phase_banner(tag: { text: "Beta" }) do %>This is a new service, your
      <%= govuk_link_to("feedback (opens in a new tab)", ENV["FEEDBACK_URL"] || 'https://www.trade-tariff.service.gov.uk/feedback', target: "_blank") %>
      will help us improve it.
    <% end %>
    <main class="govuk-main-wrapper app-main-class" id="main-content">
      <%= render 'flashes' %>
      <%= yield %>
    </main>
  </div>
  </body>

  <%= govuk_footer(meta_items_title: "Helpful links", meta_items: {
    "API Documentation" => TradeTariffDevHub.documentation_url,
    "Feedback" =>  TradeTariffDevHub.feedback_url,
    "Privacy policy" => privacy_path,
    "Cookies" => cookies_path,
    "Terms and conditions" => TradeTariffDevHub.terms_and_conditions_url,
  }) %>
</html>
