<%= govuk_back_link(text: "Back to dashboard", href: root_path) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <%= govuk_notification_banner(
      title_text: "Important",
      text: "Your client secrets are shown below. Keep them secure and do not share them publicly."
    ) %>

    <h1 class="govuk-heading-l">Manage UK Trade Tariff Client Secrets</h1>

    <p class="govuk-body">
      Use this page to view and manage your client credentials for accessing the UK Trade Tariff APIs.
    </p>

    <%= govuk_button_link_to("Create new client secret", "/tariff/new", secondary: true) %>

    <% if @client_secrets.empty? %>
      <%= govuk_inset_text(text: "No client secrets have been created yet.") %>
    <% else %>
      <%= govuk_table do |table|
        table.with_caption(text: "Your client secrets", size: "m")
        table.with_head do |head|
          head.with_row do |row|
            row.with_cell(text: "Client Name")
            row.with_cell(text: "Client ID")
            row.with_cell(text: "Client Secret")
            row.with_cell(text: "Actions", numeric: true)
          end
        end
        table.with_body do |body|
          @client_secrets.each do |secret|
            body.with_row do |row|
              row.with_cell(text: secret.client_name)
              row.with_cell(text: secret.client_id.truncate(20, omission: '...'))
              row.with_cell { secret.client_secret.truncate(20, omission: '...') }
              row.with_cell do
                concat govuk_button_to("Edit Secret", "#", class: "fixed-width-button")
                concat " "
                concat govuk_button_to("Disable", "#", warning: true, class: "fixed-width-button", data: { confirm: "Are you sure you want to disable this client secret?" })
              end
            end
          end
        end
      end %>
    <% end %>

    <%= govuk_details(summary_text: "What are client secrets?") do %>
      <p class="govuk-body">
        Client secrets are used to authenticate your application when accessing the UK Trade Tariff APIs via OAuth 2.0.
        Each client has a unique <strong>Client ID</strong> and <strong>Client Secret</strong>. Keep the secret confidential
        and use it only in secure server-side code.
      </p>
      <p class="govuk-body">
        You can create new client secrets or delete existing ones as needed. Contact support if you suspect a secret has been compromised.
      </p>
    <% end %>
  </div>
</div>
